!function(u){u(document).ready(function(){new Vue({el:"#wp-ultimo-wrap",delimiters:["<%","%>"],data:{type:"message",style:"success",message:"",subject:"",previewHTML:""},mounted:function(){postboxes.add_postbox_toggles(pagenow,{}),list.init();var a=this;window.tinyMCE.onAddEditor.add(function(e,t){t.onKeyUp.add(function(e,t){a.message=e.getContent()})}),u(".wp-editor-area").on("keyup",function(){a.message=u(this).val()})},methods:{setType:function(e,t){e.preventDefault(),this.type=t},showModal:function(e,t){e.preventDefault()}}});u("#wu-broadcast-plans").select2({placeholder:wu_broadcast_sender.placeholder_plans}),u("#wu-broadcast-users").select2({minimumInputLength:3,tags:[],ajax:{url:ajaxurl,dataType:"json",type:"GET",quietMillis:50,data:function(e){return{term:e,action:"wu_query_user"}},results:function(e){return{results:u.map(e,function(e){return{text:e.data.display_name+" ("+e.data.user_email+")",slug:e.data.user_login,id:e.data.ID}})}}}}),u(document).on("click","#save-message, #preview-message",function(e){e.preventDefault();var t=u(this),a=t.attr("name"),s=t.html(),n=tinyMCE.get("post_content").getContent();t.attr("disabled","disabled").html(". . ."),u("#wp-ultimo-send-broadcast").block({message:null,overlayCSS:{background:"#F1F1F1",opacity:.4}});var o=t.parents("form").serialize()+"&message_action="+a+"&post_content="+n;u.ajax({url:ajaxurl,method:"post",data:o,dataType:"json",success:function(e){t.html(e.message),u("#wp-ultimo-send-broadcast").unblock(),setTimeout(function(){t.html(s).removeAttr("disabled"),e.status&&"submit"===a&&list.update()},3e3)}})})})}(jQuery);